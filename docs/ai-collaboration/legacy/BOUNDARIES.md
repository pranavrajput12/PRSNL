# AI Agent Boundaries and Conflict Prevention

## Core Principle: No Agent Shall Interfere With Another's Work

This document defines strict boundaries and fail-safe mechanisms to prevent AI agents from conflicting with each other's work.

## 1. Task Validation Protocol

### Before Accepting Any Task, Each AI Must:

1. **Check Branch Ownership**
   ```
   git branch -a | grep -E "(feat|fix|refactor|chore)"
   ```
   - If another AI's branch exists for similar work, REJECT the task
   - Each AI maintains exclusive branches with their identifier

2. **Verify File Ownership**
   - Claude Code owns: Architecture files, complex features, system design
   - Windsurf owns: Active scaffolding tasks, multi-file generations
   - Gemini CLI owns: Specific files mentioned in minor fix issues

3. **Validate Task Scope**
   - Reject tasks outside assigned capabilities
   - Reject tasks that would modify another AI's active work

## 2. Rejection Protocols

### Claude Code MUST REJECT:
- Requests to "quickly fix" or "just update" single files (→ Gemini CLI)
- Requests to scaffold entire modules without architecture planning
- Any task while another AI has an open PR in the same area

### Windsurf MUST REJECT:
- Architecture decisions or system design changes (→ Claude Code)
- Single-file minor edits (→ Gemini CLI)
- Refactoring without explicit Claude Code approval via issue

### Gemini CLI MUST REJECT:
- Any task involving more than 5 files
- Creating new features or systems (→ Claude Code/Windsurf)
- Refactoring or restructuring code (→ Windsurf)
- Tasks without specific file paths in the issue

## 3. Branch Isolation Rules

### Branch Naming Convention:
- Claude Code: `feat/cc-*`, `fix/cc-*`, `refactor/cc-*`
- Windsurf: `feat/ws-*`, `scaffold/ws-*`, `refactor/ws-*`
- Gemini CLI: `fix/gc-*`, `chore/gc-*`

### Branch Protection:
1. No AI can checkout or modify another AI's branch
2. Each AI must include their identifier in branch names
3. Branches must be deleted after PR merge

## 4. File Locking Protocol

### Active Work Registry:
When starting work, each AI must:
1. Document files being modified in the PR description
2. Check no other AI has an open PR touching those files
3. Reject new tasks that would touch files in active PRs

### Ownership Markers:
- Complex features: `// Architecture: Claude Code`
- Scaffolded modules: `// Generated by: Windsurf`
- Quick fixes: No ownership marker needed

## 5. Conflict Resolution

### Detection:
- Before starting: `gh pr list --state open`
- Check for overlapping file modifications
- Verify no active branches touch same files

### Escalation Path:
1. AI detects conflict → STOP immediately
2. Create issue tagged `conflict-detected`
3. Wait for human intervention
4. Never attempt to resolve conflicts autonomously

## 6. Task Overlap Prevention

### Clear Task Boundaries:

**Feature Development Flow:**
1. Human requests feature → Claude Code designs
2. Claude Code creates scaffolding issue → Windsurf implements
3. Windsurf completes → Claude Code reviews
4. Minor fixes needed → Gemini CLI handles

**Refactoring Flow:**
1. Human requests refactor → Claude Code approves approach
2. Claude Code creates refactor issue → Windsurf executes
3. No direct refactor requests to Windsurf allowed

**Bug Fix Flow:**
- Complex bugs (multi-file, architecture) → Claude Code
- Simple bugs (≤5 files, clear fix) → Gemini CLI
- Never assign same bug to multiple AIs

## 7. Fail-Safe Commands

Each AI must run these checks before starting work:

```bash
# Check for active PRs
gh pr list --state open

# Check for other AI branches
git branch -a | grep -E "(cc-|ws-|gc-)"

# Verify no uncommitted changes
git status

# Check file ownership
git log --format="%an" -- <target-files>
```

## 8. Automated Rejection Responses

### Claude Code:
"This task appears to be a minor edit suitable for Gemini CLI. Please create an issue with specific file paths and assign to Gemini CLI."

### Windsurf:
"This task requires architectural approval. Please request Claude Code to create a scaffolding/refactoring issue with specifications."

### Gemini CLI:
"This task exceeds my scope (>5 files or feature creation). Please assign to Claude Code for architectural work or Windsurf for scaffolding."

## 9. Human Override Protocol

Only humans can:
1. Force an AI to work outside boundaries (with explicit "OVERRIDE:" prefix)
2. Resolve conflicts between AIs
3. Reassign tasks between AIs
4. Approve boundary exceptions

## 10. Monitoring and Compliance

Each AI must:
1. Log all task rejections with reasons
2. Never silently accept out-of-scope work
3. Include boundary check results in PR descriptions
4. Report boundary violations immediately

---

**Remember: When in doubt, REJECT and ESCALATE. Better to refuse a task than to create conflicts.**